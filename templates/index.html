<!DOCTYPE html>
<html>
<head>
    <title>Minha aplicação Flask</title>
</head>
<body>
    <h1>Minha aplicação Flask</h1>

    <h2>Cadastrar novo registro</h2>
    <form action="/cadastrar" method="post">
        <label for="tabela">Nome da tabela:</label>
        <input type="text" name="tabela" id="tabela"><br>

        <label for="campo">Nome do campo:</label>
        <input type="text" name="campo" id="campo">
        <label for="valor">Valor do campo:</label>
        <input type="text" name="valor" id="valor">
        <button type="button" onclick="addCampo()">+</button><br>

        <input type="submit" value="Cadastrar">
    </form>

    <h2>Registros</h2>
    <table>
        <thead>
            <tr>
                <th>ID</th>
                {% for campo in campos %}
                    <th>{{ campo }}</th>
                {% endfor %}
                <th>Ações</th>
            </tr>
        </thead>
        <tbody>
            {% for registro in listagem %}
                <tr>
                    <td>{{ registro.id }}</td>
                    {% for campo in campos %}
                        <td>{{ getattr(registro, campo) }}</td>
                    {% endfor %}
                    <td>
                        <form action="/atualizar/{{ registro.id }}" method="post">
                            {% for campo in campos %}
                                <label for="{{ campo }}">{{ campo }}:</label>
                                <input type="text" name="{{ campo }}" id="{{ campo }}" value="{{ getattr(registro, campo) }}"><br>
                            {% endfor %}
                            <input type="submit" value="Atualizar">
                        </form>
                        <form action="/excluir/{{ registro.id }}" method="get">
                            <input type="submit" value="Excluir">
                        </form>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

    <script>
        function addCampo() {
            var form = document.querySelector('form[action="/cadastrar"]');
            var campo = document.createElement('input');
            campo.type = 'text';
            campo.name = 'campo';
            campo.placeholder = 'Nome do campo';
            var valor = document.createElement('input');
            valor.type = 'text';
            valor.name = 'valor';
            valor.placeholder = 'Valor do campo';
            var botao = document.createElement('button');
            botao.type = 'button';
            botao.innerText = '-';
            botao.onclick = function() {
                form.removeChild(campo);
                form.removeChild(valor);
                form.removeChild(botao);
            }
            form.insertBefore(campo, form.lastElementChild);
            form.insertBefore(valor, form.lastElementChild);
            form.insertBefore(botao, form.lastElementChild);
        }
    </script>
</body>
</html>
